!function(e){"use strict";function t(t){var n=t.parents(".ngl-embed").find(".ngl-embed-content"),a=t.parents(".ngl-embed").attr("data-block-id"),l=t.val(),r="action=newsletterglue_ajax_get_embed&security="+newsletterglue_params.ajaxnonce+"&block_id="+a+"&url="+encodeURIComponent(l);e.ajax({type:"post",url:newsletterglue_params.ajaxurl,data:r,beforeSend:function(){n.empty()},success:function(e){e.error&&n.html('<div class="ngl-embed-error">'+e.error+"</div>"),e.html&&n.html(e.html)}})}if(e(document).on("change","#ngl_embed_url",function(n){t(e(this))}),e(document).on("keyup","#ngl_embed_url",function(n){"Enter"!==n.key&&13!==n.keyCode||t(e(this))}),e(".ngl-embed-url").length)setInterval(function(){e(".ngl-embed-url").each(function(){var t=e(this),n=e(this).parents(".ngl-embed").find(".ngl-embed-content"),a=e(this).parents(".ngl-embed").find(".ngl-embed-error");""==t.val()||a.length||e.trim(n.html()).length||t.trigger("change")})},500);e(document).on("submit",".ngl-article-add",function(t){return t.preventDefault(),function(t){var n=t.attr("data-block-id"),a=t.attr("data-date_format"),l=t.find(".ngl_article_s").attr("data-post"),r=t.find(".ngl-article-placeholder");l||(l=t.find(".ngl_article_s").val());var d="action=newsletterglue_ajax_add_article&security="+newsletterglue_params.ajaxnonce+"&block_id="+n+"&thepost="+encodeURIComponent(l)+"&date_format="+encodeURIComponent(a);e.ajax({type:"post",url:newsletterglue_params.ajaxurl,data:d,beforeSend:function(){t.find(".ngl-articles-add").find("span.ngl-article-error").remove()},success:function(e){if(console.log(e),e.error&&t.find(".ngl-articles-add").append('<span class="ngl-article-error">'+e.error+"</span>"),e.date){t.find(".ngl_article_s").val("").attr("data-post","");var n=r.clone();n.html(n.html().replace("{excerpt}",e.excerpt)),n.html(n.html().replace("{tags}",e.tags)),n.html(n.html().replace("{title}",e.title)),n.html(n.html().replace("{permalink}",e.permalink)),n.html(n.html().replace("{date}",e.date)),n.html(n.html().replace("{featured_image}",e.featured_image)),n.html(n.html().replace("{post_id}",e.post_id)),n.appendTo(t).removeClass("ngl-article-placeholder")}}})}(e(this).parents(".ngl-articles")),!1})}(jQuery);